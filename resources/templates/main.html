{{template "header"}}
<div class="row">
  {{template "paste-panel"}}

  <div class="col-lg-8">
    {{if not .Appraisal}}
    <p>This is some text that will be replaced with results</p>
    {{else}}

    <!-- Modal -->
    <div class="modal fade" id="rawTextModal" tabindex="-1" role="dialog" aria-labelledby="rawTextModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="rawTextModalLabel">Raw Pasted Text</h4>
          </div>
          <div class="modal-body">
            <pre>{{.Appraisal.Raw}}</pre>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-12">
      <div class="pull-left">
      <p class="text-left">Result <a href="/a/{{.Appraisal.ID}}">#<strong>{{.Appraisal.ID}}</strong></a> ({{.Appraisal.Kind}}) created {{relativetime .Appraisal.CreatedTime}}. <a href="#rawTextModal" data-toggle="modal">View Raw</a></p>
      </div>
    </div>

    <h4>
      <span class="nowrap">{{ prettybignumber .Appraisal.Totals.Sell }} <small>estimated sell value</small></span>
      <span class="nowrap">{{ prettybignumber .Appraisal.Totals.Buy }} <small>estimated buy value</small></span>
    </h4>

    <table class="table table-condensed table-striped">
      <tr class="header">
        <th class="text-center">Qty</th>
        <th>Item</th>
        <th class="text-right">Single (sell)<br>Single (buy)</th>
        <th class="text-right">Total (sell)<br>Total (buy)</th>
      </tr>
      {{range $item := .Appraisal.Items}}
      <tr>
        <td class="text-center">{{comma $item.Quantity}}</td>
        <td>{{if $item.TypeName}}{{$item.TypeName}}{{else}}{{$item.Name}} {{end}}</td>
        <td class="text-right">{{commaf $item.Prices.Sell.Min}}<br>{{commaf $item.Prices.Buy.Max}}</td>
        <td class="text-right">{{commaf $item.SellTotal}}<br>{{commaf $item.BuyTotal}}</td>
      </tr>
      {{end}}
    </table>
    <script type="text/javascript">
      window.history.pushState({}, "", "/a/{{.Appraisal.ID}}");
    </script>
    {{end}}

  </div>
</div>
{{template "footer"}}
